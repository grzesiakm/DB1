SELECT ename FROM emp WHERE sal=(SELECT MAX(sal) FROM emp);
 ename 
-------
 KING
(1 wiersz)

SELECT e.ename, e.job, e.empno FROM emp e WHERE e.job=(SELECT s.job FROM emp s WHERE s.empno=7369) AND e.sal>(SELECT sal t FROM emp t WHERE t.empno=7876); 
 ename  |  job  | empno 
--------+-------+-------
 MILLER | CLERK |  7934
(1 wiersz)

SELECT d.dname, d.deptno FROM dept d WHERE d.deptno IN(SELECT deptno FROM emp e WHERE e.job='CLERK');
   dname    | deptno 
------------+--------
 ACCOUNTING |     10
 RESEARCH   |     20
 SALES      |     30
(3 wiersze)

SELECT ename, sal, deptno FROM emp JOIN (SELECT MAX(sal) AS maxsal, dname, AVG(deptno) AS deptno FROM dept d JOIN emp e USING (deptno) GROUP BY dname) AS foo USING (deptno) WHERE sal=maxsal;
 ename |   sal   |       deptno        
-------+---------+---------------------
 BLAKE | 2850.00 | 30.0000000000000000
 SCOTT | 3000.00 | 20.0000000000000000
 KING  | 5000.00 | 10.0000000000000000
 FORD  | 3000.00 | 20.0000000000000000
(4 wiersze)

SELECT dname, deptno FROM dept d FULL JOIN emp e USING (deptno) WHERE empno IS NULL;
   dname    | deptno 
------------+--------
 OPERATIONS |     40
(1 wiersz)

SELECT ename, dname FROM emp JOIN dept USING (deptno);
 ename  |   dname    
--------+------------
 SMITH  | RESEARCH
 ALLEN  | SALES
 WARD   | SALES
 JONES  | RESEARCH
 MARTIN | SALES
 BLAKE  | SALES
 CLARK  | ACCOUNTING
 SCOTT  | RESEARCH
 KING   | ACCOUNTING
 TURNER | SALES
 ADAMS  | RESEARCH
 JAMES  | SALES
 FORD   | RESEARCH
 MILLER | ACCOUNTING
(14 wierszy)

SELECT dname, SUM(sal) FROM emp FULL JOIN dept USING (deptno) GROUP BY dname ;
   dname    |   sum    
------------+----------
 SALES      |  9400.00
 OPERATIONS |         
 ACCOUNTING |  8750.00
 RESEARCH   | 10875.00
(4 wiersze)

SELECT ename, dname FROM emp FULL JOIN dept USING (deptno);
 ename  |   dname    
--------+------------
 SMITH  | RESEARCH
 ALLEN  | SALES
 WARD   | SALES
 JONES  | RESEARCH
 MARTIN | SALES
 BLAKE  | SALES
 CLARK  | ACCOUNTING
 SCOTT  | RESEARCH
 KING   | ACCOUNTING
 TURNER | SALES
 ADAMS  | RESEARCH
 JAMES  | SALES
 FORD   | RESEARCH
 MILLER | ACCOUNTING
        | OPERATIONS
(15 wierszy)

SELECT w.ename, t.ename, t.grade FROM (SELECT * FROM emp e JOIN salgrade d ON e.sal BETWEEN d.losal AND d.hisal) AS w JOIN (SELECT * FROM emp e JOIN salgrade d ON e.sal BETWEEN d.losal AND d.hisal) AS t ON w.mgr=t.empno WHERE w.grade=t.grade;
 ename | ename | grade 
-------+-------+-------
 SCOTT | JONES |     4
 FORD  | JONES |     4
(2 wiersze)

SELECT e.ename, s.ename, e.dname FROM (SELECT * FROM emp JOIN dept USING (deptno)) AS e JOIN emp s ON e.mgr=s.empno WHERE e.deptno=s.deptno;
 ename  | ename |   dname    
--------+-------+------------
 SMITH  | FORD  | RESEARCH
 ALLEN  | BLAKE | SALES
 WARD   | BLAKE | SALES
 MARTIN | BLAKE | SALES
 CLARK  | KING  | ACCOUNTING
 SCOTT  | JONES | RESEARCH
 TURNER | BLAKE | SALES
 ADAMS  | SCOTT | RESEARCH
 JAMES  | BLAKE | SALES
 FORD   | JONES | RESEARCH
 MILLER | CLARK | ACCOUNTING
(11 wierszy)

SELECT DISTINCT job FROM emp WHERE comm IS NULL;
    job    
-----------
 ANALYST
 CLERK
 MANAGER
 PRESIDENT
(4 wiersze)

SELECT DISTINCT least (e.ename, s.ename) AS eename, greatest (e.ename,s.ename) AS sename FROM emp e JOIN emp s USING (mgr) WHERE e.ename<>s.ename ORDER BY eename;
 eename | sename 
--------+--------
 ALLEN  | JAMES
 ALLEN  | MARTIN
 ALLEN  | TURNER
 ALLEN  | WARD
 BLAKE  | CLARK
 BLAKE  | JONES
 CLARK  | JONES
 FORD   | SCOTT
 JAMES  | MARTIN
 JAMES  | TURNER
 JAMES  | WARD
 MARTIN | TURNER
 MARTIN | WARD
 TURNER | WARD
(14 wierszy)

SELECT * FROM (SELECT * FROM emp e WHERE job='MANAGER') AS manager JOIN (SELECT e.mgr, COUNT(*) AS how_many FROM emp e JOIN emp s ON e.mgr=s.empno GROUP BY e.mgr) AS mgr_count ON manager.empno=mgr_count.mgr WHERE how_many=1;
empno | ename |   job   | mgr  |  hiredate  |   sal   | comm | deptno | mgr  | how_many 
-------+-------+---------+------+------------+---------+------+--------+------+----------
  7782 | CLARK | MANAGER | 7839 | 1981-06-09 | 2450.00 |      |     10 | 7782 |        1
(1 wiersz)

(SELECT MAX(average), MIN(average) FROM (SELECT deptno, AVG(sal) AS average FROM emp e GROUP BY (deptno)) AS averages);
          max          |          min          
-----------------------+-----------------------
 2916.6666666666666667 | 1566.6666666666666667
(1 wiersz)




